
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Forecast Report - ProductP4</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; margin: 28px; color:#222;}
    h1,h2 { color:#2b5f8f }
    table { border-collapse: collapse; width: 70%; margin-bottom: 20px;}
    th, td { border: 1px solid #ccc; padding: 8px; text-align:center;}
    th { background:#f0f4f8; }
    .plot { max-width: 100%; height: auto; margin-bottom: 20px; border:1px solid #ddd; padding:6px; background:white;}
    .section { margin-bottom: 36px; }
    .note { color:#666; font-size:0.95rem; }
  </style>
</head>
<body>
  <h1>Forecast Report - ProductP4</h1>
  <p class="note">Auto-generated report. Train/Test split: 70 / 30. Frequency used: D. Seasonal periods (if used): 7.</p>

  <div class="section">
    <h2>1) Data summary</h2>
    <p>Data points: 100. Train from 2019-01-01 to 2019-03-11; Test from 2019-03-12 to 2019-04-10.</p>
  </div>

  <div class="section">
    <h2>2) Evaluation table</h2>
    <table>
      <thead><tr><th>Model</th><th>MAE</th><th>RMSE</th><th>MAPE (%)</th></tr></thead>
      <tbody>
        
        <tr>
          <td>SES</td>
          <td>24.070</td>
          <td>31.210</td>
          <td>49.26</td>
        </tr>
        
        <tr>
          <td>Holt</td>
          <td>28.898</td>
          <td>37.266</td>
          <td>43.02</td>
        </tr>
        
        <tr>
          <td>HoltWinters</td>
          <td>24.533</td>
          <td>29.440</td>
          <td>34.51</td>
        </tr>
        
        <tr>
          <td>ARIMA</td>
          <td>25.832</td>
          <td>32.079</td>
          <td>54.33</td>
        </tr>
        
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>3) Forecast vs Actual</h2>
    <img src="forecast_comparison.png" class="plot" alt="forecast comparison">
  </div>

  <div class="section">
    <h2>4) Diagnostics</h2>
    
      <h3>SES</h3>
      <img src="SES_diagnostics.png" class="plot" alt="SES diagnostics">
    
      <h3>Holt</h3>
      <img src="Holt_diagnostics.png" class="plot" alt="Holt diagnostics">
    
      <h3>HoltWinters</h3>
      <img src="HoltWinters_diagnostics.png" class="plot" alt="HoltWinters diagnostics">
    
      <h3>ARIMA</h3>
      <img src="ARIMA_diagnostics.png" class="plot" alt="ARIMA diagnostics">
    
  </div>

  <div class="section">
    <h2>5) Short Interpretation / Suggested conclusion</h2>
    <p class="note">
      - ดูที่ค่า RMSE/MAPE: model ที่มีค่าน้อยที่สุดจะถือว่าดีที่สุดสำหรับ dataset นี้ (ในเชิง MSE/MAE ที่วัดได้).<br>
      - ถ้า ARIMA (SARIMAX) ใช้ exogenous variables ได้ดี (และมี RMSE ต่ำกว่า) ให้พิจารณานำตัวแปรพวก price/temperature เข้า model ในการปฏิบัติจริง.<br>
      - Holt-Winters เหมาะเมื่อมี seasonality ชัด (ในที่นี้ใช้ seasonal_periods=7).<br>
    </p>
  </div>

  <footer style="margin-top:40px;color:#777;font-size:0.9rem;">
    Generated by separate.py
  </footer>
</body>
</html>